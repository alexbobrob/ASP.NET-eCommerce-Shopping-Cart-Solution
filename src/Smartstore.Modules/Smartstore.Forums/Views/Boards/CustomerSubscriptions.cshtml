@model CustomerForumSubscriptionsModel

@{
	Layout = "_MyAccount";

	Assets.AppendTitleParts(T("PageTitle.ForumSubscriptions"));

	ViewBag.PageClassToken = "forumsubscriptions";
	ViewBag.PageTitle = T("Account.ForumSubscriptions").Value;
}

@if (Model.ForumSubscriptions.Count == 0)
{
	<div class="alert alert-warning">
		@T("Account.ForumSubscriptions.NoSubscriptions")
	</div>
	return;
}

<div class="alert alert-success mb-0">
    @T("Account.ForumSubscriptions.Description")
</div>

<form asp-action="CustomerSubscriptions">
	<div class="subscription-list">
		<div class="table-responsive">
			<table class="table">
				<thead>
					<tr>
						<th style="width: 30px">
							<input type="checkbox" id="selectall" />
						</th>
						<th>
							@T("Account.ForumSubscriptions.InfoColumn")
						</th>
					</tr>
				</thead>
				<tbody>
					@foreach (var item in Model.ForumSubscriptions)
					{
						<tr>
							<td style="width: 30px">
								<input type="checkbox" name="fs@(item.Id)" class="rowcheckbox" />
							</td>
							<td dir="auto">
								<a sm-if="item.TopicSubscription" asp-route="ForumTopicBySlug" asp-route-id="@item.ForumTopicId" asp-route-slug="@item.Slug">
									@item.Title
								</a>
								<a sm-if="!item.TopicSubscription" asp-route="ForumBySlug" asp-route-id="@item.ForumId" asp-route-slug="@item.Slug">
									@item.Title
								</a>
							</td>
						</tr>
					}
				</tbody>
			</table>
		</div>
		
		@if (Model.TotalPages > 1)
		{
			<pagination sm-list-items="Model" />
		}
                
		<div class="buttons">
			<button class="btn btn-danger btn-lg" type="submit" value="delete-subs">
				@T("Account.ForumSubscriptions.DeleteSelected")
			</button>
		</div>
	</div>
</form>

<script sm-target-zone="scripts" data-origin="customer-subscriptions">
    $(function () {
    	$('#selectall').on('click', function (e) {
    		$('.subscription-list .rowcheckbox').attr('checked', $(this).is(':checked')).change();
    	});

    	$(document).on('change', '.subscription-list .rowcheckbox', function (e) {
    		var numChkBoxes = $('.subscription-list .rowcheckbox').length;
    		var numChkBoxesChecked = $('.subscription-list .rowcheckbox:checked').length;
    		$('#selectall').attr('checked', numChkBoxes == numChkBoxesChecked && numChkBoxes > 0);
    	});
    });
</script>
