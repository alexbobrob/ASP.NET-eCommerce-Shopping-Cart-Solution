@using Smartstore.Admin.Models.Export

@model List<ExportProfileModel>

@{
    ViewBag.Title = T("Common.Export").Value;
}

<div class="section-header">
    <div class="title">
        <i class="fa fa-upload"></i>
        <span>@T("Common.Export")</span>
    </div>
    <div class="options">
		<a href="javascript:void()" data-url="@Url.Action("Create")" class="btn btn-primary export-profile-button">
			<i class="fa fa-plus"></i>
			<span>@T("Admin.DataExchange.AddNewProfile")</span>
		</a>
    </div>
</div>

<div id="ExportProfileListContainer">
    @{ await Html.RenderPartialAsync("_ProfileList", Model.Where(x => !x.IsSystemProfile), new ViewDataDictionary(ViewData) { { "IsSystemProfile", false } }); }
    @{ await Html.RenderPartialAsync("_ProfileList", Model.Where(x => x.IsSystemProfile), new ViewDataDictionary(ViewData) { { "IsSystemProfile", true } }); }
</div>

<modal id="export-profile-dialog" sm-render-at-page-end="true" sm-size="Large">
    <modal-body></modal-body>
    <modal-footer>
		<button class="btn btn-secondary btn-flat" data-dismiss="modal"><span>@T("Common.Cancel")</span></button>
		<button class="btn btn-primary"><span>@T("Common.OK")</span></button>
    </modal-footer>
</modal>

<modal id="export-profile-file-dialog" sm-render-at-page-end="true" sm-size="FlexSmall">
    <modal-header sm-title="@T("Admin.DataExchange.Export.ExportFiles")"></modal-header>
    <modal-body></modal-body>
    <modal-footer>
        <button class="btn btn-secondary btn-flat" data-dismiss="modal"><span>@T("Common.Cancel")</span></button>
    </modal-footer>
</modal>

<script>
    $(function() {
        var dialog = $('#export-profile-dialog');

        // Show profile dialog.
        $(document).on('click', '.export-profile-button', function (e) {
            e.preventDefault();

            dialog.find('.modal-body').empty();
            dialog.find('.btn-primary').toggle(false);

            

            dialog.modal();
            return false;
        });

        // Show profile file dialog.
        $(document).on('click', '.export-file-count', function (e) {
            e.preventDefault();

            var fileDialog = $('#export-profile-file-dialog');
            var id = $(this).closest('.profile-row').attr('data-profile-id');

            fileDialog.find('.modal-body').empty();
            

            dialog.modal();
            return false;
        });

    });
</script>